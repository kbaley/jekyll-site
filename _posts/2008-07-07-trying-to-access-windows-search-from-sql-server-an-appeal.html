---
layout: post
title: 'Trying to access Windows Search from SQL Server: An Appeal'
date: 2008-07-07 22:03:00.000000000 -04:00
categories: []
tags:
- Conscientious Coding
status: publish
type: post
published: true
meta:
  dsq_thread_id: '358327675'
  pvc_views: '1427'
author:
  login: kyle6994
  email: kyle@baley.org
  display_name: Kyle Baley
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>Had some time to review my <a href="http://codebetter.com/blogs/kyle.baley/archive/2008/05/13/researching-search.aspx" target="_blank">search dilemma</a> today and three billable hours later, I'm no further along in my task.</p>
<p>There is no shortage of documentation on the new <a href="http://www.microsoft.com/windows/products/winfamily/desktopsearch/default.mspx" target="_blank">Windows Search</a> and I do so desperately want to try it out. Just not as a client.</p>
<p>To sum up my requirements, I have a search screen that combines meta data in a SQL database with a contents search. That is, the user types in a search word or phrase and/or selects meta data about the documents (e.g. country, document type, date, and so on and so forth).</p>
<p>At present, using Indexing Services, I am able to perform such a query within SQL Server with a single SQL Statement. That is what I would like to do with Windows Search.</p>
<p>Alas, all efforts to connect to Windows Search via SQL Server have failed. The nearest I've come is to find <a href="http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3455409&amp;SiteID=1" target="_blank">a couple</a> of <a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1007532&amp;SiteID=1" target="_blank">lost souls</a> to commiserate with who are having the same problem. I've tried every possible combination of provider, datasource, and provstr I can fathom with the connection string, Provider=Search.CollatorDSO;Extended Properties=&quot;Application=Windows&quot;, and have come up empty.</p>
<p>The issue appears to be with SQL Server as I am able to run pretty much every sample app under the sun and get search results back. I've even overcome my fear of C++ to read through some samples in the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=645300ae-5e7a-4ce7-95f0-49793f8f76e8&amp;displaylang=en" target="_blank">Search SDK</a>.</p>
<p>So I'm appealing to you, generous reader(s), for some help. I know I've broken the unwritten rule of finding at least one workable solution, however hideous, before asking for help but the nature of Windows Search is such that any workable solution would be the one I glom onto.</p>
<p>Again, the criteria is relatively straightforward: I want to be able to search for documents (Word, PowerPoint, PDF, and Excel only for the moment) based on their contents as well as metadata.</p>
<p>I can do that with Windows Search now but it would involve retrieving a result set based on metadata, retrieving a second result set based on contents, then merging the two. Given the size of the repository (about 2600 documents), this is do-able but it's the kind of bastardized union that perpetuates the hillbilly stereotype. And I'm trying to be more PC.</p>
<p>I would consider SharePoint only if someone can convince me it is an elegant solution that specifically meets these requirements. I am also open to a third-party component that indexes files and provides an API. But again, I can do this already with Windows Search. It would have to be something that can combine with SQL Server.</p>
<p>And if I don't get a decent answer, then I'm gonna...well, swear a bit maybe but that's probably it.</p>
<p>Kyle the Unthreatening</p>
