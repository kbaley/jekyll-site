---
layout: post
title: Refactoring by rote, or "How to have a ReSharper Orgy!"
date: 2007-12-14 11:30:43.000000000 -05:00
categories: []
tags:
- Refactoring
status: publish
type: post
published: true
meta:
  hl_twitter_has_auto_tweeted: 'New post: Refactoring by rote, or &quot;How to have
    a ReSharper Orgy!&quot;, Full text: http://blog.baley.org/?p=208'
  pvc_views: '1344'
  dsq_thread_id: '349693477'
author:
  login: kyle6994
  email: kyle@baley.org
  display_name: Kyle Baley
  first_name: ''
  last_name: ''
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>Greetings brothers and sisters and solidarity to you. The <a href="http://codebetter.com/blogs/kyle.baley/archive/2007/12/13/guerrilla-refactoring-or-quot-how-to-bring-down-a-totalitarian-regime-quot.aspx">revolution</a> is off to a rousing start. We have integrated continuously and Comrade Marc Davis has won a key early victory by excising the putrid web service that so fiendishly guarded our data access layer. </p>
<p>As for myself, I have just returned from a bloody battle with the enemy and have come away battered but triumphant. It was a great blow to the despots of uncohesiveness! </p>
<p>Our wily foes tried to gain the upper hand early by striking when our defenses were low. After opening a seemingly benign file, we were awash, AWASH I tell you!, in a veritable <em>SEA OF ORANGE</em> running along the right side. </p>
<p>I stared dumbfounded at the awesomeness of the task before me. &quot;How can this be?&quot; asks I, &quot;this is no mere autogenerated class? This class was typed <em>by hand. </em>Clearly by the devil himself!&quot; No matter, with a cry of &quot;ONWARD!!! TO BE RELEASED FROM UNDER THE OPPRESSIVE THUMBS OF THE HIGHLY-COUPLED SWINE-PIGS!!&quot; I leap headlong into the fray. </p>
<p>My battle begins and I become the Comment Warrior. It is a bold move because of the sheer numbers. <font face="Courier New">&lt;summary&gt;</font> tags that hold no relevance, <font face="Courier New">&lt;param&gt;</font> tags for non-existent parameters. No comment survives. Void methods have been tagged with <font face="Courier New">&lt;returns&gt;Nothing&lt;/returns&gt;</font>, a move which stuns me at first but I quickly recover. After several skirmishes, I no longer notice the empty lines of <font face="Courier New">History:</font> in the <font face="Courier New">&lt;remarks&gt;</font> tags as I go about decapitating the methods in the name of maintainability. </p>
<p>Soon, I see an opening! Find &amp; Replace can take a regular expression! After a brief two-day refresher of the syntax, the first phase is mine in one fell swoop of replacing the following expression with an empty string: </p>
<p><font face="Courier New">^:b*///.*n</font> </p>
<p>With that, the opposing army is almost 1000 less strong. But the enemy is quick and responds with waves upon waves upon waves of: </p>
<p><font face="Courier New">&#160;&#160;&#160; catch      <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw;       <br />&#160;&#160;&#160; }</font></p>
<p>along with their slightly bigger pawns*: </p>
<p><font face="Courier New">&#160;&#160;&#160; catch ( Exception ex )      <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw ex;       <br />&#160;&#160;&#160; }</font> </p>
<p>These blocks are thrown at me from *every single method*. Some even have <font face="Courier New">finally</font> calls that set object references to null. Clearly, this army's overlords were trained in the style of Crouching Tiger/Visual Basic from the late 20th century. </p>
<p>Luckily, they are easily picked up with the Blade of Alt-Enter from my ReSharper arsenal. But after untold hours, my fingers become weary. And my Mace of Shift-Ctrl-Alt-F fails me when it is unable to reformat the 6000+ soldiers remaining in this class. But I risk a glance to the right and allow myself a brief bout of euphoria as the orange gives way to the dull gray of victory. </p>
<p>By this time, the battle is all but won. I drive a final blow by <a href="http://kyle.baley.org/RegionsOrQuotHowToDisorganizeYourCodequot.aspx">deleting all regions</a> (regular expressions: <font face="Courier New">^:b*#region.*n</font> and <font face="Courier New">^:b*#endregion.*n</font>) and with a flourish of Ctrl+Alt+O, all references are properly qualified for the final victory! </p>
<p>Resistance is NOT futile! </p>
<p>Kyle the Understated</p>
<p>* Comrades Dave Woods and <a href="http://www.jameskovacs.com/blog/CommonPitfallsWhenHandlingExceptionsInNET.aspx" target="_blank">James Kovacs</a> both have posts on why this variation is particularly heinous</p>
